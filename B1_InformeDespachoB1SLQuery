USE [LINA2004]
GO

/****** Object:  View [dbo].[B1_InformeDespachoB1SLQuery]    Script Date: 02/11/2026 12:00:27 p.Â m. ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER view [dbo].[B1_InformeDespachoB1SLQuery]
as
select distinct a.docdate, /*b.date_upld fechaenv,*/ a.docnum,  a.CardCode, a.CardName
, a.u_SHIP_UDF1 'CodChofer' /*b.SHIP_UDF1*/ ,(select name from [@GONECHOFER] where code = a.u_SHIP_UDF1) 'NombreChofer'
,a.u_SHIP_UDF2 'codPlaca'/*b.SHIP_UDF2*/, (select name from [@GONECAMION] where code = a.u_SHIP_UDF2) 'Placa'
,a.u_SHIP_UDF3 'codMercaderista',(select name from [@GONEMERC] where code = a.u_SHIP_UDF3) 'Mercaderista'
, c.TrgetEntry entrega,
(select top 1 y.docnum from oinv y where y.DocEntry = (
(Select distinct top 1 x.DocEntry from INV1 x where x.BaseEntry = c.TrgetEntry and x.BaseType = 15))) Factura, a.DocTotal, d.PymntGroup,
(select top 1 y.DocTotal from oinv y where y.DocEntry = (
(Select distinct top 1 x.DocEntry from INV1 x where x.BaseEntry = c.TrgetEntry and x.BaseType = 15))) VlrFact 
from ODLN a 
--inner join OPENROWSET('MSOLEDBSQL','Server=192.168.10.8;Trusted_Connection=yes;',     [HJWE].[dbo].[SHIPHIST]) AS b on a.DocNum = b.packslip and 
--(b.packslip not like 'wo%' and b.packslip not like '%-%' and b.packslip not like 'arr%') 
inner join DLN1 c on a.DocEntry = c.docentry inner join OCTG d on a.GroupNum = d.GroupNum 
where c.TrgetEntry <>0
GO


